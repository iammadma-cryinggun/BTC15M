# BTC 15分钟 V5专业交易系统

## 📊 系统概述

基于Polymarket BTC 15分钟市场的自动交易系统，使用技术分析和机器学习。

**核心特性：**
- RSI(14) 标准指标
- VWAP计算（UTC 00:00重置）
- 多因子信号评分系统（-10到+10）
- 28%强制止损
- 预测学习系统
- 自动方向调整（基于准确率）

---

## 📈 实时性能（2026-02-24）

**实际交易统计**（176笔交易记录）：
- 总交易：67笔已完成
- 盈利：37笔（**55.2%**）
- 平均盈亏：**+2.60%**
- 盈亏比：1.17

**分数阈值**：**2.7分**
- 基于176条实际交易数据优化
- 2.0-3.0分数区间：64.6%准确率，+6.92%平均盈亏（表现最好）
- 4.0+分数区间：54.5%准确率，+0.48%平均盈亏（反而更差）

**学习系统统计**（辅助参考）：
- 总预测：35个
- 验证：33个
- 准确：22个（66.7%）
  - LONG：8/14 (57.1%)
  - SHORT：14/19 (73.7%)

---

## 📁 核心文件

### 1. auto_trader_ankr.py
**主交易系统**

**功能**：
- 实时获取Polymarket BTC 15分钟市场数据
- RSI(14)、VWAP计算
- 多因子信号评分
- 自动下单交易
- 止盈止损（1 USDC固定）
- 风控管理

**运行方式**：
```bash
python auto_trader_ankr.py
```

### 2. prediction_learning_polymarket.py
**预测学习系统**

**功能**：
- 记录每次预测
- 自动验证结果
- 统计准确率
- 参数动态调整

---

## 🚀 快速开始

### 本地运行
```bash
# 安装依赖
pip install -r requirements.txt

# 配置环境变量
cp .env.example .env
# 编辑 .env，添加你的PRIVATE_KEY

# 启动
python auto_trader_ankr.py
```

### Zeabur部署
1. 在Zeabur连接GitHub仓库
2. 配置环境变量：
   - `PRIVATE_KEY`（必须）
   - `TELEGRAM_ENABLED=true`（可选）
   - `TELEGRAM_BOT_TOKEN`（可选）
   - `TELEGRAM_CHAT_ID`（可选）
3. 自动部署

---

## 📊 交易参数

### 信号阈值
- **置信度阈值**：50%
- **做多阈值**：评分 ≥ **+2.7**（基于176条实际交易优化）
- **做空阈值**：评分 ≤ **-2.7**（2.0-3.0区间表现最好：64.6%准确率）

### 价格限制
- **最高入场价**：0.80（保留20%空间）
- **最低入场价**：0.20（避免极端）
- **平衡区间**：0.48-0.52（完全拒绝）

### 风控参数
- **最大止损**：28%
- **每笔最大**：15%余额
- **每日最大亏损**：50%
- **时间防火墙**：最后3分钟不开仓
- **连续亏损4次**：暂停0.5小时

---

## 📈 系统架构

```
核心组件
├── RSI(14) - 14周期相对强弱指标
├── VWAP - UTC 00:00重置的成交量加权平均价
├── 信号评分 - 5因子多维度分析
│   ├── 价格动量 (26%)
│   ├── 波动率 (16%)
│   ├── VWAP状态 (18%)
│   ├── RSI状态 (14%)
│   └── 趋势强度 (14%)
├── 预测学习 - SQLite数据库
└── 自动方向调整 - 基于准确率动态启用/禁用方向
```

---

## 🔧 配置说明

### 环境变量
```bash
PRIVATE_KEY=你的Polymarket钱包私钥
TELEGRAM_ENABLED=true
TELEGRAM_BOT_TOKEN=你的Bot Token
TELEGRAM_CHAT_ID=你的Chat ID
```

### 参数调整

**激进模式**（更多交易）：
```python
'min_long_score': 2.0,        # 降低做多阈值
'min_short_score': -2.0,      # 降低做空阈值
'balance_zone_min': 0.47,    # 扩大平衡区
'balance_zone_max': 0.53,
```

**保守模式**（少交易高准确）：
```python
'min_long_score': 3.0,        # 提高做多阈值
'min_short_score': -3.0,      # 提高做空阈值
'balance_zone_min': 0.49,    # 收窄平衡区
'balance_zone_max': 0.51,
```

---

## 📉 数据验证

所有数据100%来自Polymarket Gamma API：
- API端点：https://gamma-api.polymarket.com/markets
- 真实市场数据
- 自动验证预测结果

---

## 🎯 交易逻辑

### 做多信号（买YES）条件：
1. 信号评分 ≥ **+2.7**
2. RSI < 70（不超买）
3. 置信度 ≥ 50%
4. 当前价格 < 0.80（不追高）
5. LONG方向已启用

### 做空信号（买NO）条件：
1. 信号评分 ≤ **-2.7**
2. RSI > 30（不超卖）
3. 置信度 ≥ 50%
4. 当前价格 > 0.20（不追低）
5. SHORT方向已启用

### 保护机制：
- RSI > 60：限制做多
- RSI < 40：限制做空
- 0.48-0.52价格区间：完全拒绝
- 最后3分钟：拒绝开仓
- 连续亏损4次：暂停交易

---

## 📝 注意事项

1. **自动调整**：系统会自动禁用表现差的方向
2. **数据真实性**：所有数据来自Polymarket实时API
3. **15分钟周期**：市场每15分钟切换一次
4. **保证金要求**：每笔至少2 USDC

---

## 🏆 性能记录

**实际交易统计（2026-02-24）**：
- 总交易：67笔已完成
- 盈利：37笔（55.2%）
- 平均盈亏：+2.60%
- 盈亏比：1.17

**分数阈值优化**：
- 基于176条实际交易记录
- 2.0-3.0分数区间：64.6%准确率，+6.92%盈亏（最佳）
- 4.0+分数区间：54.5%准确率，+0.48%盈亏（反而更差）
- 当前阈值：**2.7分**

**学习系统辅助统计**：
- 总预测：35个
- 准确：22个（66.7%）
- SHORT方向：73.7%（活跃）
- LONG方向：57.1%（已禁用）

---

## 📞 技术支持

**GitHub**: https://github.com/iammadma-cryinggun/BTC15M

**Polymarket**: https://polymarket.com/

---

## ✅ 系统状态

- ✅ RSI(14) - 正常
- ✅ VWAP - 正常
- ✅ 信号评分 - 正常
- ✅ 学习系统 - 正常
- ✅ 数据验证 - 正常

---

**最后更新：** 2026-02-24
**版本：** V5 Professional
**部署状态：** Zeabur运行中
